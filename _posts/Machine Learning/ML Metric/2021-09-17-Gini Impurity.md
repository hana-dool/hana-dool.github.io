---
title:  "Gini index(Inpuraty)"
excerpt: "트리에서 사용되는 지니 불순도란 어떤것일까"
categories:
  - ML_Basic
last_modified_at: 2021-09-17

toc: true
toc_label: "Table Of Contents"
toc_icon: "cog"
toc_sticky: true

use_math: true
---

 주로 트리 알고리즘에서, 분기의 기준으로 선택되는것이 지니 Impurity 라고 합니다. gini impurity 는 기본적으로 '얼마나 잘 분류되었는지' 를 살펴보게 됩니다. (정확히 말하면 클수록 더 섞여있는 상태를 의미)
{: .notice--warning}

# [지니 불순도란?](#link){: .btn .btn--primary} 

- 1에서 영역 내에서 특정 클래스에 속하는 관측치들의 비율 제곱을 뺀 값입니다.

$$I(A) = 1- \sum_{k=1}^m p_k ^2$$

- $p_k$ 는 k 범주에 속하는 데이터의 비율 
- $m$ 은 범주의 갯수
- 위에서, '데이터가 거의 하나의 클래스로만 구성되어 있다면' 0에 가까운 값을 나타나게 됩니다.
  - 즉 0에 가깝다는것은 순도가 높다는것이기도 합니다. 
- 데이터의 클래스의 비율이, 모두 비슷하다면 지니계수(Impurity) 는 1에 가까운 값을 나타내게 됩니다.
  - 즉 1에 가깝다는것은 다른 클래스들이 비슷한 비율로 섞여있다는 것이고, 이는 불순도가 높다는것이 됩니다.

> ## 계산

![jpg](/assets/images/ML/9_1.png)

- 위와 같이 두 클래스의 비율이 어느정도 비슷하여 , 0.47의 값을 가지게 됩니다.

> ## 분할 후의 impurity

![jpg](/assets/images/ML/9_2.png)

- 영역을 분할하고 난 이후의 Impurity 는 위와 같습니다. 
- $R_i$ 는 분할 후 i 영역에 속하는 데이터의 비율입니다.

![jpg](/assets/images/ML/9_3.png)

- 위와 같이, 분기 후에 지니 Impurity 는 0.34 가 됩니다.
- 이전에, 분기하기 전에 gini impurity 는 0.47임을 기억합시다.
- 분기를 적절히 잘 했기떄문에, 지니 불순도는 0.47 - 0.34 = 0.13 만큼 정보를 획득하게 됩니다.

# [지니 불순도의 직관적 해석](#link){: .btn .btn--primary} 

- 그런데 왜 하필 $I(A) = 1- \sum_{k=1}^m p_k ^2 $와 같이 정의가 되었을까요? 

> ## 대칭성을 만족한다.

![jpg](/assets/images/ML/9_4.png)

- 위 그림과 같이, 클래스가 바뀌어도 같은 지니 불순도를 가져야 할 것입니다. 
- 왜냐하면 '각 클래스에 대한' 차별 없이 동등하게 대해야 하기 떄문입니다.
- 이러한 관점에서 우선 우리가 정의한 $I(A) = 1- \sum_{k=1}^m p_k ^2 $ 는 적절한 정의라고 할 수 있습니다.

> ## 확률론적 해석

- 지니 불순도를, 한가지 클래스를 선택한 이후, 그 다음에는 선택한 경우의 클래스와 다른 클래스를 선택할 확률이라고 정의할 수 있습니다.
  - 대부분이 빨간색이고 파란색이 조금 있다고 합시다.
  - 이러한 경우는 빨간색을 선택한 이후, 파란색을 선택할 확률은 낮을것입니다. 즉 '다른 색을 선택하는 확률' 을 통해서 '집합의 불순물' 을 정의할 수 있다는 것입니다.
- 2가지 색 (빨간색 ,파란색) 경우의 지니 불순도

$$Prob(빨간색)Prob(빨간색과 \space 다른 \space 색) + Prob(파란색)Prob(파란색과 \space 다른 \space 색) $$

- 이것은 2개 이상의 색으로도 쉽게 일반화할 수 있습니다.
- 그리고 이 확률은 지니 불순도 공식이 설명하는 것과 정확히 같습니다.

$$\sum_{j=1}^{J} p_j(1-p_j)$$

---

Reference

- <https://soobarkbar.tistory.com/17>
- <https://smalldataguru.com/>

 지니 Impurity 는 사실 이렇게까지 분리된 문서로 해놓아야되는거같지는 않은데.. 막상 정리하고 나니까 머쓱하네요.. 
{: .notice--success}

